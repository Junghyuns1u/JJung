# 🎮 대화형 앱 사용 가이드

## 📱 3가지 실행 방법

### 1️⃣ 웹 앱 (Streamlit) - **추천!**

브라우저에서 실행되는 멋진 GUI 앱입니다.

```bash
cd sleep_analysis
streamlit run app.py
```

**실행 후**:
- 자동으로 브라우저가 열립니다
- `Local URL: http://localhost:8501` 주소로 접속
- 마우스로 클릭하며 사용 가능

**주요 기능**:
- 📂 파일 드래그 앤 드롭으로 업로드
- 📊 실시간 그래프 표시
- 📈 인터랙티브 차트
- 💾 원클릭 다운로드
- 🎨 깔끔한 디자인

---

### 2️⃣ 대화형 메뉴 (CLI)

터미널에서 실행되는 명령어 기반 앱입니다.

```bash
cd sleep_analysis
python menu_app.py
```

**실행 후**:
- 메뉴가 표시됩니다
- 번호를 입력하여 기능 선택
- 단계별로 안내를 따라가세요

**메뉴 구성**:
```
1️⃣  데이터 불러오기 (표준 CSV)
2️⃣  dBMeter 데이터 변환 및 불러오기
3️⃣  데이터 분석 및 통계
4️⃣  그래프 보기
5️⃣  조건별 비교 분석 (A/B/C)
6️⃣  가설 검증
7️⃣  보고서 생성
8️⃣  현재 데이터 정보
9️⃣  설정 (임계값 변경)
0️⃣  종료
```

---

### 3️⃣ 빠른 분석 (스크립트)

코드 수정 없이 바로 분석하기

```bash
cd sleep_analysis
python quick_analysis.py
```

자동으로:
- 최신 데이터 로드
- 분석 실행
- 그래프 생성
- 보고서 저장

---

## 🚀 처음 사용하기

### Step 1: dBMeter 데이터 변환

```bash
python convert_dbmeter.py
```

입력:
```
📁 dBMeter 파일 경로를 입력하세요: /workspaces/JJung/Page/csv 11.15
```

출력:
```
✓ 변환 완료: data/sleep_data_20251115.csv
```

### Step 2: 웹 앱 실행

```bash
streamlit run app.py
```

### Step 3: 데이터 업로드 및 분석

1. 좌측 메뉴에서 "📂 데이터 업로드" 선택
2. "📄 표준 CSV" 탭 선택
3. 변환된 파일 선택: `data/sleep_data_20251115.csv`
4. "🔍 분석 시작" 버튼 클릭
5. "📊 데이터 분석" 메뉴로 이동하여 결과 확인!

---

## 💡 주요 기능 사용법

### 📊 데이터 분석

**웹 앱**:
- 좌측 메뉴 → "📊 데이터 분석"
- 주요 지표 카드로 한눈에 확인
- 상세 통계 테이블
- 자동 해석 제공

**CLI 메뉴**:
- 메뉴 `3` 선택
- Enter로 통계 확인

---

### 📈 그래프 보기

**웹 앱**:
- 좌측 메뉴 → "📈 그래프 보기"
- 체크박스로 표시 옵션 선택
- 인터랙티브 확대/축소
- "💾 그래프 저장" 버튼으로 다운로드

**CLI 메뉴**:
- 메뉴 `4` 선택
- 그래프 창이 팝업으로 표시

---

### 🔬 조건별 비교

여러 날의 데이터를 비교할 때 사용

**웹 앱**:
1. "🔬 조건별 비교" 메뉴
2. 조건 A, B, C 파일 각각 업로드
3. "🔍 비교 분석 시작" 클릭
4. 비교 표와 가설 검증 결과 확인

**CLI 메뉴**:
1. 메뉴 `5` 선택
2. 각 조건의 파일 경로 입력
3. 자동으로 비교 분석 실행

---

### 📄 보고서 생성

**웹 앱**:
- "📄 보고서" 메뉴
- 미리보기로 내용 확인
- "💾 텍스트 보고서 저장" 클릭
- "📊 CSV 데이터 다운로드"로 원본 데이터도 저장

**CLI 메뉴**:
- 메뉴 `7` 선택
- 조건 이름 입력 (A/B/C 또는 임의)
- `results/` 폴더에 자동 저장

---

## ⚙️ 설정 변경

### 소음 임계값 조정

**웹 앱**:
- "⚙️ 설정" 메뉴
- 슬라이더로 임계값 조정 (30-60 dB)
- 실시간 적용

**CLI 메뉴**:
- 메뉴 `9` 선택
- 새 임계값 입력

**권장 임계값**:
- **30-35 dB**: 매우 조용한 환경 (도서관 수준)
- **35-40 dB**: 일반 주택 야간 (추천)
- **40-45 dB**: 약간 시끄러운 환경
- **45-50 dB**: 시끄러운 환경 (선풍기 소음 등)

---

## 📁 파일 구조 이해하기

### 입력 파일

#### dBMeter 원본 (변환 전)
```
2025. 11. 15. 오전 3:02:46, 53.058983
2025. 11. 15. 오전 3:02:47, 55.09357
```

#### 표준 CSV (변환 후)
```csv
시간,dB
2025-11-15 03:02:46,53.1
2025-11-15 03:02:47,55.1
```

### 출력 파일

```
results/
├── real_sleep_analysis_20251115.png    # 그래프
├── report_Real_20251115.txt            # 텍스트 보고서
└── data_20251115.csv                   # CSV 데이터
```

---

## 🎯 시나리오별 사용법

### 시나리오 1: 빠르게 확인하기

```bash
# 1. 데이터 변환
python convert_dbmeter.py
# 파일 경로 입력: /path/to/dbmeter/file

# 2. 빠른 분석
python quick_analysis.py

# 3. 결과 확인
# results/ 폴더의 그래프와 보고서 확인
```

---

### 시나리오 2: 자세히 분석하기

```bash
# 웹 앱 실행
streamlit run app.py

# 브라우저에서:
# 1. 데이터 업로드
# 2. 분석 메뉴로 주요 지표 확인
# 3. 그래프 메뉴로 시각화 확인
# 4. 보고서 메뉴로 다운로드
```

---

### 시나리오 3: 조건별 비교 (3일치)

```bash
# 웹 앱 실행
streamlit run app.py

# 브라우저에서:
# 1. "조건별 비교" 메뉴
# 2. 조건 A: 평소 데이터 업로드
# 3. 조건 B: 폰 2시간 사용한 날 데이터
# 4. 조건 C: 폰 최소 사용한 날 데이터
# 5. "비교 분석 시작" 클릭
# 6. 가설 검증 결과 확인!
```

---

## 🐛 문제 해결

### 1. 웹 앱이 안 열려요

```bash
# Streamlit 재설치
pip install --upgrade streamlit

# 수동으로 브라우저 열기
streamlit run app.py --server.port 8501
# 브라우저에서 http://localhost:8501 접속
```

### 2. 그래프가 안 보여요

```bash
# matplotlib 백엔드 설정
export MPLBACKEND=TkAgg  # Linux/Mac
set MPLBACKEND=TkAgg     # Windows

# 또는 파일로만 저장
# 그래프 창 대신 파일로 자동 저장됨
```

### 3. CSV 형식 오류

**증상**: "컬럼을 찾을 수 없습니다"

**해결**:
1. dBMeter 원본이면 `convert_dbmeter.py`로 먼저 변환
2. 직접 만든 CSV면 첫 줄이 `시간,dB`인지 확인
3. 인코딩을 UTF-8로 저장

### 4. 한글이 깨져요

```bash
# 한글 폰트 설치 (Ubuntu)
sudo apt-get install fonts-nanum

# 또는 코드에서 폰트 변경
# app.py 또는 sleep_analyzer.py에서:
plt.rcParams['font.family'] = 'NanumGothic'  # 또는 다른 한글 폰트
```

---

## 💻 명령어 치트시트

### 자주 사용하는 명령어

```bash
# 웹 앱 실행
streamlit run app.py

# CLI 메뉴 실행
python menu_app.py

# 데이터 변환
python convert_dbmeter.py

# 빠른 분석
python quick_analysis.py

# 샘플 데이터 생성
python generate_sample_data.py

# 가설 검증 (여러 조건)
python hypothesis_test.py
```

### 결과 파일 확인

```bash
# 그래프 보기
open results/*.png        # Mac
xdg-open results/*.png    # Linux
start results\*.png       # Windows

# 보고서 읽기
cat results/*.txt         # 터미널에서
code results/*.txt        # VS Code로
```

---

## 🎓 학습 가이드

### 초급 (처음 사용)
1. `streamlit run app.py`로 웹 앱 실행
2. 샘플 데이터로 연습
3. 각 메뉴 하나씩 둘러보기

### 중급 (실제 분석)
1. 본인의 수면 데이터 수집
2. `convert_dbmeter.py`로 변환
3. 웹 앱에서 분석 및 해석
4. 보고서 작성

### 고급 (비교 연구)
1. 3가지 조건 데이터 수집
2. 조건별 비교 분석
3. 가설 검증
4. 과학 탐구 보고서 완성

---

## 🎨 웹 앱 화면 설명

### 홈 화면
- 프로젝트 소개
- 연구 목적
- 실험 조건
- 현재 상태 표시

### 데이터 업로드
- 표준 CSV 탭: 직접 업로드
- dBMeter 탭: 자동 변환 + 업로드
- 미리보기 및 요약 통계

### 데이터 분석
- 4개 주요 지표 카드
- 상세 통계 표
- 자동 해석 및 권장사항

### 그래프 보기
- 메인 시간-dB 그래프
- dB 분포 히스토그램
- 시간대별 평균 차트
- 그래프 다운로드

### 조건별 비교
- 3개 파일 업로드
- 비교 표
- 가설 검증 결과

### 보고서
- 마크다운 미리보기
- 텍스트 파일 저장
- CSV 데이터 다운로드

---

## 📚 추가 자료

### 참고 파일
- `README.md`: 프로젝트 전체 설명
- `QUICKSTART.md`: 빠른 시작 가이드
- `PROJECT_SUMMARY.md`: 프로젝트 요약
- `GITHUB_GUIDE.md`: GitHub 업로드 방법

### 도움말
- 웹 앱 내 "⚙️ 설정" → "❓ 도움말"
- 각 메뉴의 "?" 아이콘
- `requirements.txt`: 필요한 패키지 목록

---

## 🎯 성공 체크리스트

- [ ] 웹 앱 실행 성공
- [ ] 데이터 업로드 성공
- [ ] 분석 결과 확인
- [ ] 그래프 생성 및 저장
- [ ] 보고서 다운로드
- [ ] 임계값 조정 시도
- [ ] (선택) 조건별 비교 분석

---

**🌙 좋은 수면 분석 되세요!**
